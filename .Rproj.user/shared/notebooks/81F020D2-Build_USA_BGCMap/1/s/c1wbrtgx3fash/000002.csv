"0","library(UBL) ###contains smote function"
"0","X1$BGC <- gsub(""[[:lower:]]|[[:space:]]|[[:digit:]]"", """", X1$BGC) ###for zone model"
"0","X1 <- X1[X1$BGC != """",]"
"0","X1$BGC <- as.factor(X1$BGC)"
"0",""
"0","###This function uses mahalanobis distance to remove outlying training points below specified percentile"
"0","removeOutlier <- function(dat, alpha = 0.001){"
"0","  out <- foreach(curr = unique(as.character(dat$BGC)), .combine = rbind) %do% {"
"0","    temp <- dat[dat$BGC == curr,]"
"0","    md <- tryCatch(mahalanobis(temp[,-1],center = colMeans(temp[,-1]), cov = cov(temp[,-1])),"
"0","             error = function(e) e"
"0","    )"
"0","    if(!inherits(md,""error"")){"
"0","      ctf <- qchisq(1-alpha, df = ncol(temp)-1)"
"0","      outl <- which(md > ctf)"
"0","      cat(""Removing"", length(outl), ""outliers from"",curr, ""; "")"
"0","      if(length(outl) > 0){"
"0","        temp <- temp[-outl,]"
"0","      }"
"0","    }"
"0","    temp"
"0","    "
"0","  }"
"0","  return(out)"
"0","}"
"0",""
"0","X1.sub <- removeOutlier(X1, alpha = 0.01)"
"1","Removing"
"1"," "
"1","93"
"1"," "
"1","outliers from"
"1"," "
"1","BG"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","43"
"1"," "
"1","outliers from"
"1"," "
"1","WJP"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","116"
"1"," "
"1","outliers from"
"1"," "
"1","JPW"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","5"
"1"," "
"1","outliers from"
"1"," "
"1","CCH"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","28"
"1"," "
"1","outliers from"
"1"," "
"1","CDF"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","73"
"1"," "
"1","outliers from"
"1"," "
"1","CMA"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","133"
"1"," "
"1","outliers from"
"1"," "
"1","CMX"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","401"
"1"," "
"1","outliers from"
"1"," "
"1","CWH"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","7"
"1"," "
"1","outliers from"
"1"," "
"1","CVG"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","121"
"1"," "
"1","outliers from"
"1"," "
"1","CWF"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","237"
"1"," "
"1","outliers from"
"1"," "
"1","ESSF"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","96"
"1"," "
"1","outliers from"
"1"," "
"1","ICH"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","174"
"1"," "
"1","outliers from"
"1"," "
"1","IDF"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","115"
"1"," "
"1","outliers from"
"1"," "
"1","IGF"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","48"
"1"," "
"1","outliers from"
"1"," "
"1","IWF"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","208"
"1"," "
"1","outliers from"
"1"," "
"1","IMA"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","73"
"1"," "
"1","outliers from"
"1"," "
"1","MH"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","61"
"1"," "
"1","outliers from"
"1"," "
"1","MHRF"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","145"
"1"," "
"1","outliers from"
"1"," "
"1","MS"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","70"
"1"," "
"1","outliers from"
"1"," "
"1","PP"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","1"
"1"," "
"1","outliers from"
"1"," "
"1","GO"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","82"
"1"," "
"1","outliers from"
"1"," "
"1","MGP"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","38"
"1"," "
"1","outliers from"
"1"," "
"1","SGP"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","89"
"1"," "
"1","outliers from"
"1"," "
"1","GBD"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","6"
"1"," "
"1","outliers from"
"1"," "
"1","MSSD"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","6"
"1"," "
"1","outliers from"
"1"," "
"1","MDCH"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","3"
"1"," "
"1","outliers from"
"1"," "
"1","OW"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","13"
"1"," "
"1","outliers from"
"1"," "
"1","FG"
"1"," "
"1","; "
"1","Removing"
"1"," "
"1","0"
"1"," "
"1","outliers from"
"1"," "
"1","SBAP"
"1"," "
"1","; "
"0","X1 <- X1.sub"
"0",""
"0","# ##for equal numbers of training pnts"
"0","# tpNum <- 750 ##number of desired training points per unit"
"0","# mList <- list()"
"0","# for(BGC in unique(X1$BGC)){##Calculate multiplier"
"0","#   num <- length(X1$BGC[X1$BGC == BGC])"
"0","#   mNum <- tpNum/num"
"0","#   mList[[BGC]] <- mNum"
"0","# }"
"0",""
"0","###min number per unit"
"0","tpMin <- 200"
"0","mList <- list()"
"0","for(BGC in unique(X1$BGC)){##Calculate multiplier"
"0","  num <- length(X1$BGC[X1$BGC == BGC])"
"0","  if(num < tpMin){"
"0","    mNum <- tpMin/num"
"0","  }else{"
"0","    mNum <- 1"
"0","  }"
"0","  mList[[BGC]] <- mNum"
"0","}"
"0",""
"0",""
"0","###SMOTE!"
"0","X1.smote <- SmoteClassif(BGC ~ ., X1, C.perc = mList, k= 5 , repl = TRUE, dist = ""Euclidean"")"
"0","table(X1.smote$BGC)"
"1","
"
"1","  BG "
"1"," CCH "
"1"," CDF "
"1"," CMA "
"1"," CMX "
"1"," CRF "
"1"," CVG "
"1"," CWF "
"1"," CWH "
"1","ESSF "
"1","  FG "
"1"," GBD "
"1","  GO "
"1"," ICH "
"1"," IDF "
"1"," IGF "
"1"," IMA "
"1"," IWF "
"1"," JPW "
"1","MDCH "
"1"," MGP "
"1","  MH "
"1","MHRF "
"1","  MS "
"1","MSSD "
"1","  OW "
"1","  PP "
"1","SBAP "
"1"," SGP "
"1"," WJP "
"1","
"
"1","1229 "
"1"," 199 "
"1"," 306 "
"1"," 592 "
"1","1413 "
"1"," 200 "
"1"," 200 "
"1","1161 "
"1","6258 "
"1","3667 "
"1"," 200 "
"1","1343 "
"1"," 200 "
"1","1619 "
"1","2100 "
"1","1947 "
"1","2404 "
"1"," 476 "
"1","1345 "
"1"," 200 "
"1","1233 "
"1"," 908 "
"1"," 686 "
"1","2195 "
"1"," 200 "
"1"," 200 "
"1"," 884 "
"1"," 200 "
"1"," 516 "
"1"," 532 "
"1","
"
