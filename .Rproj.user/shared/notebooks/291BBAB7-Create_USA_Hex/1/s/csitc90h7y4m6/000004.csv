"0","source(""_Function_make_HexGrid.R"")"
"0",""
"0","CRS.albers <- CRS (""+proj=aea +lat_1=50 +lat_2=58.5 +lat_0=45 +lon_0=-126 +x_0=1000000 +y_0=0 +datum=NAD83 +units=m +no_defs"")"
"0","CRS.NAD83 <- CRS(""+init=epsg:4269"")"
"0",""
"0","### Read in the combined state boundary files for WNA"
"0","USA <- readOGR(dsn = ""./inputs/spatial_poly"", layer = ""USA_States"")"
"1","OGR data source with driver:"
"1"," "
"1","ESRI Shapefile"
"1"," "
"1","
"
"1","Source: """
"1",""
"1","C:\GitHub\Build_USA_BEC\inputs\spatial_poly"
"1",""
"1",""", layer: """
"1",""
"1","USA_States"
"1",""
"1",""""
"1",""
"1","
"
"1","with"
"1"," "
"1","14"
"1"," "
"1","features"
"1","
"
"1","It has"
"1"," "
"1","2"
"1"," "
"1","fields"
"1","
"
"0","USA <- spTransform(USA, CRS.albers)"
"0","USA_buff <- gBuffer(USA, byid=FALSE, width = 1) ##expand size of USA to capture boundaries"
"0",""
"0","size <- 800"
"0","USA_BGC_pts <- make_grid(USA_buff, cell_diameter = size, clip = FALSE)"
"0","#convert to SpatialPointsDataFrame and write shape file"
"0","  p <- data.frame (ID1 = 1 :length(USA_BGC_pts))"
"0","USA_BGC_pts2 <- SpatialPointsDataFrame(USA_BGC_pts, data = p)        "
"0",""
"0","writeOGR (obj = USA_BGC_pts2, dsn = ""./inputs/spatial_poly/USA_HexGrid_800m_new.shp"", "
"0","          layer = ""GridPoints"", driver = ""ESRI Shapefile"", overwrite_layer = TRUE)"
"0","#create CSV output for ClimateBC        "
"0","   p2 <- spTransform(USA_BGC_pts, CRS.NAD83) # to lat long in NAD83"
"0","  coords <- p2@coords"
"0","  coords <- as.data.frame(coords)"
"0","WNA_DEM <- raster(""./inputs/DEM/WNA_DEM_clipped.tif"")"
"0","projection(WNA_DEM) <- CRS.NAD83"
"0","    coords$elev <- raster::extract(WNA_DEM,p2)"
"0","  colnames(coords) <- c(""longitude"",""latitude"",""elevation"")"
"0","  coords <- as_tibble(rownames_to_column(coords, var = ""ID1""))"
"0","  #overlay of points over administrative boundaries"
"0","  USA$State <- as.character (USA$State)"
"0","  "
"0","pnt_state <- over(USA_BGC_pts, USA[,""State""],  minDimension = 1, returnList = FALSE) "
"0","  pnt_state <- as_tibble(rownames_to_column(pnt_state, var = ""ID1""))"
"0","pts.info <- left_join(pnt_state, coords,  by = ""ID1"")"
"0","pts.info2 <- pts.info %>% dplyr::select(ID1, State, latitude, longitude, elevation) #order for ClimateWNA"
"0","write.csv (pts.info2,  ""./inputs/grids/USA_800m_Grid_Climate_new.csv"", row.names = FALSE)         "
"0",""
"0","  "
"0","  USA_BGC_hex <- make_hex (USA_buff, cell_diameter = size, clip = FALSE)"
"0","#convert to SpatialPolygonsDataFrame"
"0","  o <- data.frame (ID1 = 1 :length(USA_BGC_hex))"
"0","        USA_BGC_hex2 <- SpatialPolygonsDataFrame(USA_BGC_hex, data = o)"
"0","    writeOGR (obj = USA_BGC_hex2, dsn = ""./inputs/spatial_poly/USA_HexPoly_800m_new.shp"", layer = ""HexPolys"", driver = ""ESRI Shapefile"", overwrite_layer = TRUE)"
"0",""
"0",""
